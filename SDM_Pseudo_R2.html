<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Gareth Hughes, Robin Choudhury, Neil McRoberts" />

<meta name="date" content="2018-09-19" />

<title>Summary Measures of Predictive Power for Logistic Regression Models of Disease Risk</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Information Theory</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Intro_R.html">Intro to R</a>
</li>
<li>
  <a href="information_theory_workshop_1.html">Information Theory Basics</a>
</li>
<li>
  <a href="information_theory_workshop_2.html">Bayesian Probability</a>
</li>
<li>
  <a href="information_theory_workshop_3.html">Metrics</a>
</li>
<li>
  <a href="sdm_spores.pdf">SDM Spores</a>
</li>
<li>
  <a href="SDM_Pseudo_R2.html">SDM Predictivity</a>
</li>
<li>
  <a href="about.html">Readings</a>
</li>
<li>
  <a href="responses.html">Responses</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Summary Measures of Predictive Power for Logistic Regression Models of Disease Risk</h1>
<h4 class="author"><em>Gareth Hughes, Robin Choudhury, Neil McRoberts</em></h4>
<h4 class="date"><em>September 19, 2018</em></h4>

</div>


<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">TRUE</span>) <span class="co">#change this to FALSE to suppress printing the code</span>
<span class="kw">library</span>(tidyverse)</code></pre></div>
<pre><code>## -- Attaching packages -------------------------------------------- tidyverse 1.2.1 --</code></pre>
<pre><code>## v ggplot2 3.0.0     v purrr   0.2.5
## v tibble  1.4.2     v dplyr   0.7.6
## v tidyr   0.8.1     v stringr 1.3.1
## v readr   1.1.1     v forcats 0.3.0</code></pre>
<pre><code>## -- Conflicts ----------------------------------------------- tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(pROC)</code></pre></div>
<pre><code>## Type &#39;citation(&quot;pROC&quot;)&#39; for a citation.</code></pre>
<pre><code>## 
## Attaching package: &#39;pROC&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     cov, smooth, var</code></pre>
<div id="abstract" class="section level1">
<h1>Abstract</h1>
<p>For an ordinary least squares regression model, the coefficient of determination <span class="math inline">\(R^2\)</span> describes the proportion (or percentage) of variance of the response variable explained by the model, and is a widely-accepted summary measure of predictive power. A number of <span class="math inline">\(R^2\)</span>-analogues are available as summary measures of predictive power for logistic regression models, including models of disease risk. Tjur’s <span class="math inline">\(R^2\)</span> and McFadden’s <span class="math inline">\(R^2\)</span> are of particular interest in this context. Both these <span class="math inline">\(R^2\)</span>-analogues have transparent derivations, which reveal that they apply to different aspects of model evaluation. Tjur’s <span class="math inline">\(R^2\)</span> is a measure of separation between (known) actual states (e.g., gold standard determinations of “healthy” or “diseased” status) whereas McFadden’s <span class="math inline">\(R^2\)</span> is a measure of separation between predicted states (e.g., forecasts of disease status based on models of disease risk). This clarifies their interpretation in the context of evaluation of logistic regression models of disease risk. In addition, versions of both Tjur’s <span class="math inline">\(R^2\)</span> and McFadden’s <span class="math inline">\(R^2\)</span> may be obtained from analyses of disease risk that are not preceded by logistic regression analysis.</p>
<div id="additional-keywords" class="section level2">
<h2>Additional Keywords</h2>
<p>discrimination, resolution, Nagelkerke’s <span class="math inline">\(R^2\)</span>, logarithmic scoring rule</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Analysis of SDM data from Choudhury et al 2016.</span>
<span class="co"># Get the data and take a look at the top of the data file</span>

data&lt;-<span class="kw">read_csv</span>(<span class="st">&quot;data/roc.test.csv&quot;</span>) </code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   Disease = col_integer(),
##   Spore = col_double(),
##   `Spore-1` = col_double(),
##   `Spore-2` = col_double(),
##   `Spore-3` = col_double(),
##   `Spore-4` = col_double(),
##   `Spore-5` = col_double(),
##   `Spore-6` = col_double(),
##   `Spore-7` = col_double(),
##   `Spore-8` = col_double(),
##   `Spore-9` = col_double()
## )</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(data)</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Disease"],"name":[1],"type":["int"],"align":["right"]},{"label":["Spore"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Spore-1"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Spore-2"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Spore-3"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Spore-4"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Spore-5"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Spore-6"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["Spore-7"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["Spore-8"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["Spore-9"],"name":[11],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"6.537430","3":"7.035893","4":"5.437927","5":"0.000000","6":"5.869424","7":"5.272307","8":"6.195007","9":"4.363799","10":"7.061326","11":"6.854497"},{"1":"1","2":"8.891759","3":"11.473769","4":"6.197309","5":"6.537430","6":"7.035893","7":"5.437927","8":"0.000000","9":"5.869424","10":"5.272307","11":"6.195007"},{"1":"1","2":"7.677910","3":"9.731590","4":"8.331837","5":"10.220110","6":"8.199024","7":"8.891759","8":"11.473769","9":"6.197309","10":"6.537430","11":"7.035893"},{"1":"1","2":"9.195537","3":"11.229594","4":"10.395754","5":"7.677910","6":"9.731590","7":"8.331837","8":"10.220110","9":"8.199024","10":"8.891759","11":"11.473769"},{"1":"1","2":"6.091219","3":"8.259370","4":"7.538378","5":"7.692036","6":"8.510132","7":"6.708603","8":"4.847567","9":"5.291142","10":"5.104247","11":"8.013057"},{"1":"1","2":"10.430875","3":"NA","4":"9.099595","5":"7.769757","6":"8.944169","7":"7.204131","8":"4.593401","9":"6.091219","10":"8.259370","11":"7.538378"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fit the basic logistic regression on Disease using Spore.4</span>
dismodel1 &lt;-<span class="st"> </span><span class="kw">glm</span>(Disease<span class="op">~</span><span class="st">`</span><span class="dt">Spore-4</span><span class="st">`</span>,<span class="dt">family=</span><span class="kw">binomial</span>(<span class="dt">link=</span><span class="st">&#39;logit&#39;</span>), <span class="dt">data =</span> data) <span class="co">#I needed to put tics (`) around Spore-4 because when i loaded it with read_csv it read it as &#39;Spore-4&#39;, not &#39;Spore.4&#39; rac</span>
<span class="kw">summary</span>(dismodel1)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Disease ~ `Spore-4`, family = binomial(link = &quot;logit&quot;), 
##     data = data)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.5702  -1.2047   0.8288   1.0275   1.7194  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept) -1.21930    0.62024  -1.966   0.0493 *
## `Spore-4`    0.19279    0.08197   2.352   0.0187 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 114.76  on 82  degrees of freedom
## Residual deviance: 108.55  on 81  degrees of freedom
##   (4 observations deleted due to missingness)
## AIC: 112.55
## 
## Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The Spore trap DNA count lagged by 4 observation periods (roughly 8-12 days) does have some positive association with subsequent disease state. Although the estimated effect of lagged spore trap signal is unlikely to be due to chance alone the odds of disease do not increase strongly with increase in the signal. This is the sort of situation where having a richer diagnosis of what the fitted model is doing would be useful.</p>
<p>To that end, we ask for McFadden’s and Tjur’s pseudo Rsq values for the model. Looking at the two values together tells us that the model has low discrimination capacity (Tjur) and would (consequently?) have a modest impact in probability updating (McFadden). We can look at the diagnostic plots to look at data, fitted model and “Tjur” histogram of the fitted probabilities.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Take a look at the fitted probability values from the regression.</span>
fits1&lt;-<span class="kw">as.numeric</span>(dismodel1<span class="op">$</span>fitted.values) <span class="co"># need this because fitted.values is a list and while hist understands what</span>
                                           <span class="co"># to do with it if you don&#39;t monkey about with it, asking it to sub-divide</span>
                                           <span class="co"># the vector of values using the logical == confuses it, so we have to </span>
                                           <span class="co"># pull the numerical bit out of the list.</span>
dis_state2&lt;-dismodel1<span class="op">$</span>model<span class="op">$</span>Disease <span class="co">#this pulls it directly from the model rac</span>
spore4_rac&lt;-dismodel1<span class="op">$</span>model<span class="op">$</span><span class="st">`</span><span class="dt">Spore-4</span><span class="st">`</span> <span class="co">#this pulls it directly from the model rac</span>

<span class="co">#I&#39;m going to redo this in ggplot/tidyr feel free to ignore RAC</span>
SDM_rac&lt;-<span class="kw">data.frame</span>(<span class="dt">fits1=</span>fits1, <span class="dt">disease=</span>dis_state2, <span class="dt">spore4=</span>spore4_rac)
SDM_rac1&lt;-SDM_rac <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(.,<span class="dt">status=</span><span class="kw">ifelse</span>(disease<span class="op">==</span><span class="dv">0</span>, <span class="st">&quot;Non-cases&quot;</span>, <span class="st">&quot;Cases&quot;</span>)) 

SDM_rac1<span class="op">$</span>status &lt;-<span class="st"> </span><span class="kw">factor</span>(SDM_rac1<span class="op">$</span>status, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Cases&quot;</span>,<span class="st">&quot;Non-cases&quot;</span>))

<span class="kw">ggplot</span>(SDM_rac1, <span class="kw">aes</span>(fits1, <span class="dt">fill=</span>status))<span class="op">+</span>
<span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">color=</span><span class="st">&quot;black&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(status<span class="op">~</span>., <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>)<span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Fitted Probability Value&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;grey20&quot;</span>, <span class="st">&quot;grey80&quot;</span>))<span class="op">+</span>
<span class="st">    </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,
        <span class="dt">legend.background =</span> <span class="kw">element_blank</span>(),
        <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">face=</span><span class="st">&quot;bold&quot;</span>, <span class="dt">size =</span> <span class="dv">16</span>),
        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>),
        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Figure 1&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill=</span><span class="kw">guide_legend</span>(<span class="dt">title =</span> <span class="st">&quot;Status&quot;</span>))</code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="SDM_Pseudo_R2_files/figure-html/tjur%20histogram-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggsave</span>(<span class="dt">filename =</span> <span class="st">&quot;figures/sdm_dot_hist_facet.png&quot;</span>)</code></pre></div>
<pre><code>## Saving 7 x 5 in image
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  <span class="co"># Generate a plot of binary disease variable and fitted probabilities</span>
<span class="co"># There are four NA values corresponding to zeros in the data.  Dump</span>
<span class="co"># the NA values and make a reduced vector for plotting the results</span>
<span class="co">#Spore4&lt;-na.omit(data$`Spore-4`) #couldnt get this to work rac</span>
<span class="co">#plot(Spore4,dismodel1$fitted.values, xlab=&quot;ln(DNA copies)&quot;, ylab=&quot;Probability&quot;, col=&quot;dark blue&quot;,ylim=c(0,1))</span>
<span class="co">#points(Spore.4,Disease, col=&quot;red&quot;)</span>

SDM_rac_spore_melt=SDM_rac <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(est.type, disease, <span class="op">-</span>spore4)

<span class="kw">ggplot</span>(SDM_rac_spore_melt, <span class="kw">aes</span>(spore4, disease, <span class="dt">color=</span>est.type))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Log of Spore Copy Number&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Probability&quot;</span>)<span class="op">+</span><span class="st"> </span><span class="co">#not sure this is the right label? rac</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Fitted vs. Real Disease, SDM Data&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">2</span>,.<span class="dv">8</span>),
        <span class="dt">legend.background =</span> <span class="kw">element_blank</span>(),
        <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">face=</span><span class="st">&quot;bold&quot;</span>, <span class="dt">size =</span> <span class="dv">16</span>),
        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>),
        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">color=</span><span class="kw">guide_legend</span>(<span class="dt">title =</span> <span class="st">&quot;Estimate Type&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Disease Incidence&quot;</span>,<span class="st">&quot;Fitted Disease Data&quot;</span>))</code></pre></div>
<p><img src="SDM_Pseudo_R2_files/figure-html/logistic%20regression%20plot-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">ggsave</span>(<span class="dt">filename =</span> <span class="st">&quot;figures/sdm_real_fit.png&quot;</span>)</code></pre></div>
<pre><code>## Saving 7 x 5 in image</code></pre>
<div id="calculating-tjurs-r2" class="section level2">
<h2>Calculating Tjur’s <span class="math inline">\(R^2\)</span></h2>
<p>Tjur (2009) quantifies this separation in terms of the coefficient of discrimination, <span class="math inline">\(D\)</span>, where <span class="math inline">\(D=\bar{\hat{p}}_{c}-\bar{\hat{p}}_{nc}\)</span> in which <span class="math inline">\(\bar{\hat{p}}_{c}\)</span> and <span class="math inline">\(\bar{\hat{p}}_{nc}\)</span> denote the means of the histograms characterizing the frequency distributions of fitted probabilities for the case and non-case groups, respectively, and <span class="math inline">\(0 &lt; D &lt; 1\)</span>. Thus <span class="math inline">\(D\)</span> characterizes the predictive power of a logistic regression model in terms of the separation between predictions for the case and non-case groups, on a probability scale (i.e., discrimination). We calculate D on the basis of the fitted probability values for individual subjects as calculated in the model output, not as binned for Figure 1.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pc&lt;-<span class="kw">mean</span>(<span class="kw">subset</span>(SDM_rac, disease <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)<span class="op">$</span>fits1)
pnc&lt;-<span class="kw">mean</span>(<span class="kw">subset</span>(SDM_rac, disease <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)<span class="op">$</span>fits1)
d=pc<span class="op">-</span>pnc
<span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;Tjur&#39;s coefficient of discrimination is&quot;</span>, <span class="kw">round</span>(d,<span class="dv">4</span>)))</code></pre></div>
<pre><code>## [1] &quot;Tjur&#39;s coefficient of discrimination is 0.0735&quot;</code></pre>
</div>
<div id="visualizing-tjurs-r2-coefficient" class="section level2">
<h2>Visualizing Tjur’s <span class="math inline">\(R^2\)</span> Coefficient</h2>
<p>While the histogram displayed in figure 1 matches the format from Tjur (2009), linking the histogram to the Tjur’s <span class="math inline">\(R^2\)</span> coefficient can help to visualize this value. Now we can more easily see how Tjur’s D relates to the predicted cases and non-cases.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(SDM_rac1, <span class="kw">aes</span>(fits1, <span class="dt">fill=</span>status))<span class="op">+</span>
<span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="dt">position =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">alpha=</span><span class="fl">0.5</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span>
<span class="st">   </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span>pc, <span class="dt">color=</span><span class="st">&quot;#002C6AFF&quot;</span>)<span class="op">+</span>
<span class="st">   </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span>pnc, <span class="dt">color=</span><span class="st">&quot;#CBBA69FF&quot;</span>)<span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> pnc<span class="op">+</span>(pc<span class="op">+</span>pnc)<span class="op">/</span><span class="dv">200</span>, <span class="dt">y =</span> <span class="fl">9.2</span>, <span class="dt">xend =</span> pc<span class="op">-</span>(pc<span class="op">+</span>pnc)<span class="op">/</span><span class="dv">200</span>, <span class="dt">yend =</span> <span class="fl">9.2</span>),  <span class="dt">size=</span><span class="dv">2</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> pc<span class="op">-</span>(pc<span class="op">+</span>pnc)<span class="op">/</span><span class="dv">200</span>, <span class="dt">y =</span> <span class="fl">9.2</span><span class="op">+</span><span class="fl">0.2</span>, <span class="dt">xend =</span> pc<span class="op">-</span>(pc<span class="op">+</span>pnc)<span class="op">/</span><span class="dv">200</span>, <span class="dt">yend =</span> <span class="fl">9.2</span><span class="op">-</span><span class="fl">0.2</span>), <span class="dt">size=</span><span class="dv">2</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> pnc<span class="op">+</span>(pc<span class="op">+</span>pnc)<span class="op">/</span><span class="dv">200</span>, <span class="dt">y =</span> <span class="fl">9.2</span><span class="op">+</span><span class="fl">0.2</span>, <span class="dt">xend =</span> pnc<span class="op">+</span>(pc<span class="op">+</span>pnc)<span class="op">/</span><span class="dv">200</span>, <span class="dt">yend =</span> <span class="fl">9.2</span><span class="op">-</span><span class="fl">0.2</span>), <span class="dt">size=</span><span class="dv">2</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;italic(D)&quot;</span>, <span class="dt">parse=</span>T, <span class="dt">x =</span> (pc<span class="op">+</span>pnc)<span class="op">/</span><span class="dv">2</span>, <span class="dt">y =</span> <span class="dv">10</span>, <span class="dt">size =</span> <span class="dv">8</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Fitted Probability Value&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#002C6AFF&quot;</span>, <span class="st">&quot;#CBBA69FF&quot;</span>))<span class="op">+</span>
<span class="st">    </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">2</span>, .<span class="dv">8</span>),
        <span class="dt">legend.background =</span> <span class="kw">element_blank</span>(),
        <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">face=</span><span class="st">&quot;bold&quot;</span>, <span class="dt">size =</span> <span class="dv">16</span>),
        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>),
        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Figure 1 Visualizing Tjur&#39;s Coefficient of Discrimination (&quot;</span>, <span class="kw">italic</span>(<span class="st">&quot;D&quot;</span>), <span class="st">&quot;)&quot;</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill=</span><span class="kw">guide_legend</span>(<span class="dt">title =</span> <span class="st">&quot;Status&quot;</span>))</code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="SDM_Pseudo_R2_files/figure-html/tjur%20histogram%20coefficient-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggsave</span>(<span class="dt">filename =</span> <span class="st">&quot;figures/sdm_dot_hist_facet.png&quot;</span>)</code></pre></div>
<pre><code>## Saving 7 x 5 in image
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div id="roc-analysis-and-calculating-youdens-j" class="section level2">
<h2>ROC analysis and Calculating Youden’s <span class="math inline">\(J\)</span></h2>
<p>Completing a Receiver Operating Characteristic (ROC) analysis can help to highlight useful thresholds for binary predictors. One commonly used statistic to assess the diagnostic test is the Youden’s index (commonly referred to as the Youden’s <span class="math inline">\(J\)</span>). This value ranges between 0 and 1, and is calculated as <span class="math inline">\(J=sensitivity + speficifity - 1\)</span>, where sensitivity is written as <span class="math inline">\(\hat{p}_{+|c}\)</span>, and specificity is <span class="math inline">\(\hat{p}_{-|nc}\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">roc_<span class="dv">4</span>&lt;-<span class="kw">roc</span>(data<span class="op">$</span>Disease, data<span class="op">$</span><span class="st">`</span><span class="dt">Spore-4</span><span class="st">`</span>)
youden_j&lt;-<span class="kw">data.frame</span>(<span class="kw">as.list</span>(<span class="kw">coords</span>(roc_<span class="dv">4</span>, <span class="dt">x=</span><span class="st">&quot;best&quot;</span>, <span class="dt">input=</span><span class="st">&quot;threshold&quot;</span>, <span class="dt">best.method=</span><span class="st">&quot;youden&quot;</span>))) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">inv_spec=</span><span class="dv">1</span><span class="op">-</span>specificity,
         <span class="dt">youden_j=</span>sensitivity<span class="op">+</span>specificity<span class="op">-</span><span class="dv">1</span>);youden_j</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["threshold"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["specificity"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sensitivity"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["inv_spec"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["youden_j"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"7.68561","2":"0.6923077","3":"0.6818182","4":"0.3076923","5":"0.3741259"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggroc</span>(roc_<span class="dv">4</span>, <span class="dt">legacy.axes =</span> T)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data=</span>youden_j, <span class="kw">aes</span>(inv_spec, sensitivity), <span class="dt">shape=</span><span class="dv">21</span>, <span class="dt">size=</span><span class="dv">4</span>, <span class="dt">fill=</span><span class="st">&quot;red&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Youdens J&quot;</span>,<span class="dt">x =</span> youden_j<span class="op">$</span>inv_spec, <span class="dt">y =</span> youden_j<span class="op">$</span>sensitivity<span class="op">+</span><span class="fl">0.1</span>, <span class="dt">size=</span><span class="dv">8</span> )</code></pre></div>
<p><img src="SDM_Pseudo_R2_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">SDM_rac2&lt;-<span class="st"> </span>SDM_rac1 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">status_pred_youden =</span> <span class="kw">ifelse</span>(spore4<span class="op">&gt;</span>youden_j<span class="op">$</span>threshold, <span class="st">&quot;Cases&quot;</span>, <span class="st">&quot;Non-cases&quot;</span>),
         <span class="dt">status_pred_count =</span> <span class="kw">ifelse</span>(spore4<span class="op">&gt;</span>youden_j<span class="op">$</span>threshold, <span class="dv">1</span>, <span class="dv">0</span>),
         <span class="dt">status_pred_count_test =</span> <span class="kw">ifelse</span>(fits1<span class="op">&gt;</span><span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>))
case_prior=<span class="st"> </span><span class="kw">sum</span>(SDM_rac2<span class="op">$</span>disease)<span class="op">/</span><span class="kw">nrow</span>(SDM_rac2)
control_prior=<span class="dv">1</span><span class="op">-</span>case_prior

p_c_plus&lt;-SDM_rac2 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(status_pred_youden <span class="op">==</span><span class="st"> &quot;Cases&quot;</span>)
p_c_plus&lt;-<span class="kw">sum</span>(p_c_plus<span class="op">$</span>disease)<span class="op">/</span><span class="kw">nrow</span>(p_c_plus)
p_nc_plus&lt;-<span class="dv">1</span><span class="op">-</span>p_c_plus

p_c_minus&lt;-SDM_rac2 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(status_pred_youden <span class="op">==</span><span class="st"> &quot;Non-cases&quot;</span>)
p_c_minus&lt;-<span class="kw">sum</span>(p_c_minus<span class="op">$</span>disease)<span class="op">/</span><span class="kw">nrow</span>(p_c_minus)
p_nc_minus&lt;-<span class="dv">1</span><span class="op">-</span>p_c_minus</code></pre></div>
</div>
<div id="calculating-mcfaddens-r2" class="section level2">
<h2>Calculating McFadden’s <span class="math inline">\(R^2\)</span></h2>
<p>Whereas Tjur’s <span class="math inline">\(R^2\)</span> is a measure of separation between (known) actual states (e.g., gold standard determinations of “healthy” or “diseased” status), McFadden’s <span class="math inline">\(R^2\)</span> is a measure of separation between predicted states (e.g., forecasts of disease status based on models of disease risk). In other words, Tjur’s <span class="math inline">\(R^2\)</span> is a discrimination metric, and McFadden’s <span class="math inline">\(R^2\)</span> is a resolution metric, defined conditionally on the disease forecast.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">case_count&lt;-<span class="kw">sum</span>(SDM_rac2<span class="op">$</span>disease)
control_count&lt;-<span class="kw">nrow</span>(SDM_rac2)<span class="op">-</span>case_count

log_score_case_prior&lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(case_prior)
log_score_control_prior&lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(control_prior)

S0&lt;-log_score_case_prior<span class="op">*</span>case_count <span class="op">+</span><span class="st"> </span>log_score_control_prior<span class="op">*</span>control_count

log_p_c_plus&lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(p_c_plus)
log_p_nc_plus&lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(p_nc_plus)
log_p_c_minus&lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(p_c_minus)
log_p_nc_minus&lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(p_nc_minus)

p_nc_pred_count&lt;-SDM_rac2 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(status_pred_youden <span class="op">==</span><span class="st"> &quot;Non-cases&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">count</span>(status)

p_c_pred_count&lt;-SDM_rac2 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(status_pred_youden <span class="op">==</span><span class="st"> &quot;Cases&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">count</span>(status)

S&lt;-log_p_c_plus<span class="op">*</span>p_c_pred_count[<span class="dv">1</span>,<span class="dv">2</span>] <span class="op">+</span>
<span class="st">  </span>log_p_nc_plus<span class="op">*</span>p_c_pred_count[<span class="dv">2</span>,<span class="dv">2</span>] <span class="op">+</span>
<span class="st">  </span>log_p_c_minus<span class="op">*</span>p_nc_pred_count[<span class="dv">1</span>,<span class="dv">2</span>] <span class="op">+</span>
<span class="st">  </span>log_p_nc_minus<span class="op">*</span>p_nc_pred_count[<span class="dv">2</span>,<span class="dv">2</span>]

mcfaddens&lt;-<span class="dv">1</span><span class="op">-</span>(S<span class="op">/</span>S0)
<span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;McFadden&#39;s coefficient of discrimination is&quot;</span>, <span class="kw">round</span>(mcfaddens,<span class="dv">4</span>)))</code></pre></div>
<pre><code>## [1] &quot;McFadden&#39;s coefficient of discrimination is 0.1034&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">maddala&lt;-<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>(<span class="dv">2</span><span class="op">/</span><span class="kw">nrow</span>(SDM_rac2))<span class="op">*</span>(S0<span class="op">-</span>S))

nagelkerke&lt;-<span class="st"> </span>maddala <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>(<span class="dv">2</span><span class="op">/</span><span class="kw">nrow</span>(SDM_rac2))<span class="op">*</span>(S0)))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sessionInfo</span>()</code></pre></div>
<pre><code>## R version 3.5.1 (2018-07-02)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 16299)
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=English_United States.1252 
## [2] LC_CTYPE=English_United States.1252   
## [3] LC_MONETARY=English_United States.1252
## [4] LC_NUMERIC=C                          
## [5] LC_TIME=English_United States.1252    
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] bindrcpp_0.2.2  pROC_1.12.1     forcats_0.3.0   stringr_1.3.1  
##  [5] dplyr_0.7.6     purrr_0.2.5     readr_1.1.1     tidyr_0.8.1    
##  [9] tibble_1.4.2    ggplot2_3.0.0   tidyverse_1.2.1
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_0.12.18     cellranger_1.1.0 pillar_1.3.0     compiler_3.5.1  
##  [5] plyr_1.8.4       bindr_0.1.1      tools_3.5.1      digest_0.6.15   
##  [9] lubridate_1.7.4  jsonlite_1.5     evaluate_0.11    nlme_3.1-137    
## [13] gtable_0.2.0     lattice_0.20-35  pkgconfig_2.0.2  rlang_0.2.2     
## [17] cli_1.0.0        rstudioapi_0.7   yaml_2.2.0       haven_1.1.2     
## [21] withr_2.1.2      xml2_1.2.0       httr_1.3.1       knitr_1.20      
## [25] hms_0.4.2        rprojroot_1.3-2  grid_3.5.1       tidyselect_0.2.4
## [29] glue_1.3.0       R6_2.2.2         readxl_1.1.0     rmarkdown_1.10  
## [33] reshape2_1.4.3   modelr_0.1.2     magrittr_1.5     backports_1.1.2 
## [37] scales_1.0.0     htmltools_0.3.6  rvest_0.3.2      assertthat_0.2.0
## [41] colorspace_1.3-2 labeling_0.3     stringi_1.2.4    lazyeval_0.2.1  
## [45] munsell_0.5.0    broom_0.5.0      crayon_1.3.4</code></pre>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
