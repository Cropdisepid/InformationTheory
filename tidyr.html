<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Kelsey Andersen" />


<title>Data import and Tidy-ing</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; }
td.sourceCode { padding-left: 5px; }
code > span.kw { font-weight: bold; } /* Keyword */
code > span.dt { text-decoration: underline; } /* DataType */
code > span.co { font-style: italic; } /* Comment */
code > span.al { font-weight: bold; } /* Alert */
code > span.er { font-weight: bold; } /* Error */
code > span.wa { font-style: italic; } /* Warning */
code > span.cf { font-weight: bold; } /* ControlFlow */
code > span.pp { font-weight: bold; } /* Preprocessor */
code > span.do { font-style: italic; } /* Documentation */
code > span.an { font-style: italic; } /* Annotation */
code > span.cv { font-style: italic; } /* CommentVar */
code > span.in { font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Epidemiology & Data Science</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Syllabus</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    R for Data Science
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="robin.html">Data Visualization</a>
    </li>
    <li>
      <a href="dplyr2.html">Dplyr and Scripts</a>
    </li>
    <li>
      <a href="Ravin_EDA_v3.html">Exploratory Data Analysis in R</a>
    </li>
    <li>
      <a href="tidyr.html">Data Import and Tidy</a>
    </li>
  </ul>
</li>
<li>
  <a href="Day3.html">Disease progress</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Data import and Tidy-ing</h1>
<h4 class="author"><em>Kelsey Andersen</em></h4>

</div>


<p>Adapted from <a href="http://r4ds.had.co.nz/">R for Data Science</a> by Hadley Wichkam and Garrett Grolemund</p>
<p><br />
</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)</code></pre></div>
<div id="getting-data-into-r" class="section level1">
<h1>Getting data into R!</h1>
<p><em>Maybe the most important step?</em></p>
<p> </p>
<div id="base-r" class="section level2">
<h2>Base R</h2>
<ul>
<li><strong>read.csv()</strong> is the function avaiable from base R, and maybe the one you are most familiar with
<ul>
<li>This function reads data directly into a data frame so to use other packages (like dplyr) you will need to convert to a tibble yourself</li>
<li>You can specify if first columns of data are headers using header = TRUE</li>
</ul></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">FAO1 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;FAOSTAT_data.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p> </p>
</div>
<div id="readr" class="section level2">
<h2>readr</h2>
<ul>
<li><strong>read_csv()</strong> (from <strong>readr</strong> package) makes data from a .csv file right into a <em>tibble</em>
<ul>
<li>up to 10x faster than <strong>read.csv()</strong></li>
<li>reads in data directly as a tibble</li>
<li>tibbles play better with your console window (pays attention to how wide your console window is) and is implemented through the dplyr package</li>
</ul></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)

FAO1 &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;FAOSTAT_data.csv&quot;</span>)</code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   Country = col_character(),
##   Element = col_character(),
##   Item = col_character(),
##   Year = col_integer(),
##   Unit = col_character(),
##   Value = col_integer()
## )</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">FAO1</code></pre></div>
<pre><code>## # A tibble: 40 x 6
##    Country  Element        Item     Year Unit  Value
##    &lt;chr&gt;    &lt;chr&gt;          &lt;chr&gt;   &lt;int&gt; &lt;chr&gt; &lt;int&gt;
##  1 Cambodia Area harvested Bananas  2007 ha    30000
##  2 Cambodia Area harvested Bananas  2008 ha    32000
##  3 Cambodia Area harvested Bananas  2009 ha    33000
##  4 Cambodia Area harvested Bananas  2010 ha    35002
##  5 Cambodia Area harvested Bananas  2011 ha    32574
##  6 Cambodia Area harvested Bananas  2012 ha    31844
##  7 Cambodia Area harvested Bananas  2013 ha    31757
##  8 Cambodia Area harvested Bananas  2014 ha    31741
##  9 Cambodia Area harvested Bananas  2015 ha    31786
## 10 Cambodia Area harvested Bananas  2016 ha    31875
## # ... with 30 more rows</code></pre>
<div id="some-tips-for-read_csv" class="section level4">
<h4>Some tips for <strong>read_csv()</strong></h4>
<ul>
<li>Use skip = n to skip n nows if there are rows of metadata above your column headers.</li>
<li>Use col_names = FALSE if there are no row headings or</li>
<li>col_names = c(“x”, “y”, “z”) to pass a vector of column names to the data table</li>
<li>use na = “.” to specify what missing values look like</li>
</ul>
<p>Say that after import, you notice that you would like to change one of your variable types, you can do that by specifying the variable type for each column. For example, let’s say we want to change year to character:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">FAO2 &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;FAOSTAT_data.csv&quot;</span>, <span class="dt">col_types =</span> <span class="kw">cols</span>(
    <span class="dt">Country =</span> <span class="kw">col_character</span>(),
    <span class="dt">Element =</span> <span class="kw">col_character</span>(),
    <span class="dt">Item =</span> <span class="kw">col_character</span>(),
    <span class="dt">Year =</span> <span class="kw">col_character</span>(), ### changed year to character
    <span class="dt">Unit =</span> <span class="kw">col_character</span>(),
    <span class="dt">Value =</span> <span class="kw">col_integer</span>()
  ))
FAO2</code></pre></div>
<pre><code>## # A tibble: 40 x 6
##    Country  Element        Item    Year  Unit  Value
##    &lt;chr&gt;    &lt;chr&gt;          &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;int&gt;
##  1 Cambodia Area harvested Bananas 2007  ha    30000
##  2 Cambodia Area harvested Bananas 2008  ha    32000
##  3 Cambodia Area harvested Bananas 2009  ha    33000
##  4 Cambodia Area harvested Bananas 2010  ha    35002
##  5 Cambodia Area harvested Bananas 2011  ha    32574
##  6 Cambodia Area harvested Bananas 2012  ha    31844
##  7 Cambodia Area harvested Bananas 2013  ha    31757
##  8 Cambodia Area harvested Bananas 2014  ha    31741
##  9 Cambodia Area harvested Bananas 2015  ha    31786
## 10 Cambodia Area harvested Bananas 2016  ha    31875
## # ... with 30 more rows</code></pre>
</div>
<div id="read-directly-from-excel-files-using-the-tidyverse-package-readxl" class="section level3">
<h3>Read directly from excel files using the tidyverse package <strong>readxl</strong></h3>
<ul>
<li>read_excel() detects file path <em>-</em> read_xlsx() reads directly from .xlsx file</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">FAOxls &lt;-<span class="st"> </span>readxl::<span class="kw">read_excel</span>(<span class="st">&quot;FAOSTAT_data2.xlsx&quot;</span>)
FAOxls</code></pre></div>
<pre><code>## # A tibble: 40 x 6
##    Country  Element        Item     Year Unit   Value
##    &lt;chr&gt;    &lt;chr&gt;          &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
##  1 Cambodia Area harvested Bananas 2007. ha    30000.
##  2 Cambodia Area harvested Bananas 2008. ha    32000.
##  3 Cambodia Area harvested Bananas 2009. ha    33000.
##  4 Cambodia Area harvested Bananas 2010. ha    35002.
##  5 Cambodia Area harvested Bananas 2011. ha    32574.
##  6 Cambodia Area harvested Bananas 2012. ha    31844.
##  7 Cambodia Area harvested Bananas 2013. ha    31757.
##  8 Cambodia Area harvested Bananas 2014. ha    31741.
##  9 Cambodia Area harvested Bananas 2015. ha    31786.
## 10 Cambodia Area harvested Bananas 2016. ha    31875.
## # ... with 30 more rows</code></pre>
</div>
<div id="read-in-other-data-types" class="section level3">
<h3>Read in other data types</h3>
<ul>
<li>Read in SPSS, Stata and SAS files using package <strong>haven</strong></li>
</ul>
<p> </p>
<p> </p>
</div>
</div>
</div>
<div id="what-is-tidy-data" class="section level1">
<h1>What is “tidy” data?</h1>
<p>Let’s take a look at three data sets (more info at <a href="https://www.youtube.com/watch?v=y9KJmUGc8SE">this Rstudio webinar!</a>)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#devtools::install_github(&quot;rstudio/EDAWR&quot;) </span>
<span class="kw">library</span>(EDAWR)</code></pre></div>
<pre><code>## 
## Attaching package: &#39;EDAWR&#39;</code></pre>
<pre><code>## The following objects are masked _by_ &#39;.GlobalEnv&#39;:
## 
##     a, b, y</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     storms</code></pre>
<pre><code>## The following objects are masked from &#39;package:tidyr&#39;:
## 
##     population, who</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stormsA &lt;-<span class="st"> </span>EDAWR::storms ## so it doesn&#39;t get confused with built-in NOAA weather data!</code></pre></div>
<p> </p>
<div id="lets-examine-three-built-in-datasets" class="section level4">
<h4>Let’s examine three built-in datasets:</h4>
<p>  First, ‘cases’:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cases</code></pre></div>
<pre><code>##   country  2011  2012  2013
## 1      FR  7000  6900  7000
## 2      DE  5800  6000  6200
## 3      US 15000 14000 13000</code></pre>
<p>Notice that each variable stored in its own cell:</p>
<ul>
<li>Country is in a column<br />
</li>
<li>Year is in a row</li>
</ul>
<p>  Next, ‘polution’:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pollution</code></pre></div>
<pre><code>##       city  size amount
## 1 New York large     23
## 2 New York small     14
## 3   London large     22
## 4   London small     16
## 5  Beijing large    121
## 6  Beijing small     56</code></pre>
<p>In ‘pollution’, variables “amount of small particles” and “amount of large particles” are not in their own column. Therefore, doing math with them would be difficult!<br />
  Finally, ‘stormsA’:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stormsA</code></pre></div>
<pre><code>## # tibble [6 × 4]
##   storm    wind pressure date      
##   &lt;chr&gt;   &lt;int&gt;    &lt;int&gt; &lt;date&gt;    
## 1 Alberto   110     1007 2000-08-03
## 2 Alex       45     1009 1998-07-27
## 3 Allison    65     1005 1995-06-03
## 4 Ana        40     1013 1997-06-30
## 5 Arlene     50     1010 1999-06-11
## 6 Arthur     45     1010 1996-06-17</code></pre>
<p>This format, where each variable is in it’s own column, is much easier to work with!</p>
<ul>
<li>What if we want to make a ratio of pressure to wind?</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stormsB &lt;-<span class="st"> </span>(stormsA$pressure /<span class="st"> </span>stormsA$wind)
stormsB</code></pre></div>
<pre><code>## [1]  9.154545 22.422222 15.461538 25.325000 20.200000 22.444444</code></pre>
<p>   </p>
</div>
</div>
<div id="tidyr" class="section level1">
<h1>Tidyr</h1>
<ul>
<li>Tidy data has each variable saved in it’s own column &amp;</li>
<li>Each observation has a row &amp;</li>
<li>Each value in it’s own cell!<br />
</li>
<li>this package is similar to Reshape2 (cast and melt)<br />
</li>
<li>Best practice to organize your data this way now, and avoid the pain of data cleaning later!</li>
</ul>
<div id="in-the-book-r-for-data-science-there-are-three-data-table-examples.-which-one-is-tidy" class="section level4">
<h4>In the book (R for Data Science) there are three data table examples. Which one is “tidy”?</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">table1</code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   country      year  cases population
##   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt;
## 1 Afghanistan  1999    745   19987071
## 2 Afghanistan  2000   2666   20595360
## 3 Brazil       1999  37737  172006362
## 4 Brazil       2000  80488  174504898
## 5 China        1999 212258 1272915272
## 6 China        2000 213766 1280428583</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">table2</code></pre></div>
<pre><code>## # A tibble: 12 x 4
##    country      year type            count
##    &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;           &lt;int&gt;
##  1 Afghanistan  1999 cases             745
##  2 Afghanistan  1999 population   19987071
##  3 Afghanistan  2000 cases            2666
##  4 Afghanistan  2000 population   20595360
##  5 Brazil       1999 cases           37737
##  6 Brazil       1999 population  172006362
##  7 Brazil       2000 cases           80488
##  8 Brazil       2000 population  174504898
##  9 China        1999 cases          212258
## 10 China        1999 population 1272915272
## 11 China        2000 cases          213766
## 12 China        2000 population 1280428583</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">table3</code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   country      year rate             
## * &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;            
## 1 Afghanistan  1999 745/19987071     
## 2 Afghanistan  2000 2666/20595360    
## 3 Brazil       1999 37737/172006362  
## 4 Brazil       2000 80488/174504898  
## 5 China        1999 212258/1272915272
## 6 China        2000 213766/1280428583</code></pre>
</div>
<div id="only-table-1" class="section level4">
<h4>Only table 1!</h4>
<p>Notice that each column is a variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">table1</code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   country      year  cases population
##   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt;
## 1 Afghanistan  1999    745   19987071
## 2 Afghanistan  2000   2666   20595360
## 3 Brazil       1999  37737  172006362
## 4 Brazil       2000  80488  174504898
## 5 China        1999 212258 1272915272
## 6 China        2000 213766 1280428583</code></pre>
</div>
<div id="graph-your-tidy-data" class="section level3">
<h3>Graph your tidy data</h3>
<div id="using-the-data-in-table-1-you-can-easily-graph" class="section level4">
<h4>Using the data in Table 1, you can easily graph!</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">ggplot</span>(table1, <span class="kw">aes</span>(year, cases)) +
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> country), <span class="dt">color =</span> <span class="st">&quot;gray30&quot;</span>) +
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> country)) +
<span class="st">  </span><span class="kw">theme_minimal</span>()</code></pre></div>
<p><img src="tidyr_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="or-using-our-tidy-fao-data-we-can-see-how-much-area-of-cassava-changed-over-time-in-each-country" class="section level4">
<h4>Or, using our tidy FAO data, we can see how much area of Cassava changed over time in each country</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">FAO3 &lt;-<span class="st"> </span>FAO2 %&gt;%<span class="st"> </span><span class="kw">filter</span>(Item ==<span class="st"> &quot;Cassava&quot;</span>)
<span class="kw">library</span>(ggplot2)
<span class="kw">ggplot</span>(FAO3, <span class="kw">aes</span>(Year, Value)) +
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> Country)) +
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Area planted (ha)&quot;</span>) +
<span class="st">  </span><span class="kw">theme_minimal</span>()</code></pre></div>
<p><img src="tidyr_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="getting-un-tidy-data-into-shape" class="section level3">
<h3>Getting un-tidy data into shape</h3>
<p>Let’s look at the “cases” dataset from earlier<br />
 </p>
</div>
<div id="spreading-and-gathering" class="section level3">
<h3>Spreading and Gathering</h3>
<p> </p>
<div id="gathering" class="section level4">
<h4>Gathering</h4>
<p>Let’s ‘gather’ the ‘cases’ dataset!</p>
<ul>
<li>Function = <em>gather()</em>
<ul>
<li>Key column<br />
</li>
<li>Value column<br />
</li>
<li>Names of columns to collapse</li>
</ul></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cases</code></pre></div>
<pre><code>##   country  2011  2012  2013
## 1      FR  7000  6900  7000
## 2      DE  5800  6000  6200
## 3      US 15000 14000 13000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cases2 &lt;-<span class="st"> </span><span class="kw">gather</span>(cases, <span class="dt">key =</span> <span class="st">&quot;year&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;n&quot;</span>, <span class="dv">2</span>:<span class="dv">4</span>)
cases2</code></pre></div>
<pre><code>##   country year     n
## 1      FR 2011  7000
## 2      DE 2011  5800
## 3      US 2011 15000
## 4      FR 2012  6900
## 5      DE 2012  6000
## 6      US 2012 14000
## 7      FR 2013  7000
## 8      DE 2013  6200
## 9      US 2013 13000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cases3 &lt;-<span class="st"> </span>cases %&gt;%<span class="st"> </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;year&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;n&quot;</span>, <span class="st">&quot;2011&quot;</span>, <span class="st">&quot;2012&quot;</span>, <span class="st">&quot;2013&quot;</span>)</code></pre></div>
</div>
<div id="spreading" class="section level4">
<h4>Spreading</h4>
<p>Let’s ‘spread’ the pollution dataset<br />
 </p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pollution</code></pre></div>
<pre><code>##       city  size amount
## 1 New York large     23
## 2 New York small     14
## 3   London large     22
## 4   London small     16
## 5  Beijing large    121
## 6  Beijing small     56</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pollution2 &lt;-<span class="st"> </span><span class="kw">spread</span>(pollution, size, amount)
pollution2</code></pre></div>
<pre><code>##       city large small
## 1  Beijing   121    56
## 2   London    22    16
## 3 New York    23    14</code></pre>
<p> </p>
</div>
<div id="recap-adapted-from-g.-gromland" class="section level4">
<h4>Recap (adapted from G. Gromland)</h4>
<p> </p>
<div class="figure">
<img src="Images/Picture1.jpg" />

</div>
<p> </p>
</div>
</div>
<div id="separating-and-uniting" class="section level3">
<h3>Separating and uniting</h3>
<p> </p>
<div id="separate-splits-a-column-by-a-character-string-seperator" class="section level4">
<h4>separate() splits a column by a character string seperator</h4>
<ul>
<li>Let’s look at the storms data!<br />
</li>
<li>Year, month and day are “hidden” variables</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stormsA</code></pre></div>
<pre><code>## # tibble [6 × 4]
##   storm    wind pressure date      
##   &lt;chr&gt;   &lt;int&gt;    &lt;int&gt; &lt;date&gt;    
## 1 Alberto   110     1007 2000-08-03
## 2 Alex       45     1009 1998-07-27
## 3 Allison    65     1005 1995-06-03
## 4 Ana        40     1013 1997-06-30
## 5 Arlene     50     1010 1999-06-11
## 6 Arthur     45     1010 1996-06-17</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stormsC &lt;-<span class="st"> </span><span class="kw">separate</span>(stormsA, date, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;month&quot;</span>, <span class="st">&quot;day&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;-&quot;</span>)
stormsC</code></pre></div>
<pre><code>## # tibble [6 × 6]
##   storm    wind pressure year  month day  
##   &lt;chr&gt;   &lt;int&gt;    &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
## 1 Alberto   110     1007 2000  08    03   
## 2 Alex       45     1009 1998  07    27   
## 3 Allison    65     1005 1995  06    03   
## 4 Ana        40     1013 1997  06    30   
## 5 Arlene     50     1010 1999  06    11   
## 6 Arthur     45     1010 1996  06    17</code></pre>
</div>
<div id="unite-does-the-inverse-of-seperate" class="section level4">
<h4>Unite() does the inverse of seperate!</h4>
<ul>
<li>Unites columns into a single variable</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stormsD &lt;-<span class="st"> </span>stormsC %&gt;%<span class="st"> </span><span class="kw">unite</span>(<span class="st">&quot;date&quot;</span>, year, month, day, <span class="dt">sep =</span> <span class="st">&quot;-&quot;</span>)
stormsD</code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   storm    wind pressure date      
##   &lt;chr&gt;   &lt;int&gt;    &lt;int&gt; &lt;chr&gt;     
## 1 Alberto   110     1007 2000-08-03
## 2 Alex       45     1009 1998-07-27
## 3 Allison    65     1005 1995-06-03
## 4 Ana        40     1013 1997-06-30
## 5 Arlene     50     1010 1999-06-11
## 6 Arthur     45     1010 1996-06-17</code></pre>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
